import{j as e,t as bs,A as d,C as Ge,a as x,B as n,u as Je,v as Ue,w as $,x as es,s as ss,q as b,b as t,c as g,y as p,M as c,L as m,T as w,S as as,z as ps}from"./ui-vendor-H-3CurRd.js";import{u as ws,a as r}from"./react-vendor-DIDCmA_u.js";import{u as ks,S as Cs,N as Ss}from"./useMetrics-BfELKp6-.js";import{a as o}from"./index-C3neANUc.js";import{H as Ds}from"./HostnameEditModal-ByvmimBC.js";import"./http-vendor-B9ygI19o.js";function Ts(){const K=localStorage.getItem("access_token"),ts=localStorage.getItem("username")||"Unknown",Y=ws(),[He,Re]=r.useState(!1),[Ee,ls]=r.useState([]),[rs,Ae]=r.useState(!0),[Fe,h]=r.useState(null),[Q,ns]=r.useState({}),[Te,Me]=r.useState(null),[is,Ze]=r.useState(!1),[A,W]=r.useState(null),[k,X]=r.useState(""),[G,J]=r.useState("homelab"),[U,ee]=r.useState(!0),[se,ae]=r.useState(""),[te,le]=r.useState(""),[re,ne]=r.useState(!0),[F,j]=r.useState(!1),[ze,C]=r.useState(null),[cs,Pe]=r.useState(!1),[os,Oe]=r.useState(!1),[i,ie]=r.useState(null),[ce,Be]=r.useState([]),[oe,de]=r.useState(null),[S,xe]=r.useState(""),[D,me]=r.useState("A"),[_,he]=r.useState(""),[ue,ge]=r.useState(""),[je,ye]=r.useState(!0),[T,N]=r.useState(null),[ds,y]=r.useState(!1),[xs,H]=r.useState(!1),[M,R]=r.useState(null),[Ne,fe]=r.useState(null),[ve,ms]=r.useState([]),[Le,hs]=r.useState({homelab:[],lan:[]}),[Ie,Ve]=r.useState(!1),[Z,z]=r.useState(null),[E,be]=r.useState(null),[pe,we]=r.useState(null),[P,qe]=r.useState(null),[O,$e]=r.useState(null),[Ke,Ye]=r.useState(!1),[B,ke]=r.useState(null),{connectionStatus:us}=ks(K);r.useEffect(()=>{if(!K){Y("/login");return}Ce(),We(),Qe(),gs()},[K,Y]);const Qe=async()=>{Ve(!0),z(null);try{const[s,a,l]=await Promise.all([o.getDhcpNetworks(),o.getDnsDynamicEntries("homelab"),o.getDnsDynamicEntries("lan")]);ms(s),hs({homelab:a,lan:l})}catch(s){const a=s&&typeof s=="object"&&"response"in s&&s.response&&typeof s.response=="object"&&"data"in s.response?String(s.response.data?.detail):s instanceof Error?s.message:"Failed to load dynamic DNS data";z(a)}finally{Ve(!1)}},Ce=async()=>{Ae(!0),h(null);try{const s=await o.getDnsZones();ls(s)}catch(s){h(s?.response?.data?.detail||s.message||"Failed to load DNS zones")}finally{Ae(!1)}},We=async()=>{try{const[s,a]=await Promise.all([o.getDnsServiceStatus("homelab"),o.getDnsServiceStatus("lan")]);ns({homelab:s,lan:a})}catch(s){console.error("Failed to fetch DNS service statuses:",s)}},gs=async()=>{try{const[s,a]=await Promise.all([o.getDnsNetworkSettings("homelab"),o.getDnsNetworkSettings("lan")]);qe(s),$e(a)}catch(s){console.error("Failed to fetch DNS network settings:",s)}},Xe=async(s,a)=>{Ye(!0),ke(null);try{const l=await o.updateDnsNetworkSettings(s,{forward_unlisted:a});s==="homelab"?qe({forward_unlisted:a}):$e({forward_unlisted:a}),ke(l.message),setTimeout(()=>ke(null),5e3)}catch(l){h(l?.response?.data?.detail||l.message||"Failed to update DNS settings")}finally{Ye(!1)}},u=async(s,a)=>{const l=`${s}-${a}`;Me(l);try{await o.controlDnsService(s,a),setTimeout(()=>{We()},1e3)}catch(v){h(v?.response?.data?.detail||v.message||`Failed to ${a} DNS service`)}finally{Me(null)}},L=s=>{const a=Q[s.network];return!a||!a.exists?{is_active:!1,is_enabled:!1}:{is_active:a.is_active,is_enabled:a.is_enabled}},I=async(s,a)=>{try{const l=await o.getDnsRecords(s,a);Be(l)}catch(l){h(l?.response?.data?.detail||l.message||"Failed to load DNS records")}},js=()=>{localStorage.removeItem("access_token"),localStorage.removeItem("username"),Y("/login")},f=(s,a)=>{s?(W(s),X(s.name),J(s.network),ee(s.authoritative),ae(s.forward_to||""),le(s.delegate_to||""),ne(s.enabled)):(W(null),X(""),J(a||"homelab"),ee(!0),ae(""),le(""),ne(!0)),C(null),Ze(!0)},Se=()=>{Ze(!1),W(null),C(null)},ys=async()=>{C(null),j(!0);try{if(!k.trim()){C("Zone name is required"),j(!1);return}if(A){const s={name:k.trim(),network:G,authoritative:U,forward_to:se.trim()||null,delegate_to:te.trim()||null,enabled:re};await o.updateDnsZone(A.name,A.network,s)}else{const s={name:k.trim(),network:G,authoritative:U,forward_to:se.trim()||null,delegate_to:te.trim()||null,enabled:re};await o.createDnsZone(s)}await Ce(),Se()}catch(s){C(s?.response?.data?.detail||s.message||"Failed to save zone")}finally{j(!1)}},Ns=async()=>{if(M)try{await o.deleteDnsZone(M.name,M.network),await Ce(),y(!1),R(null)}catch(s){h(s?.response?.data?.detail||s.message||"Failed to delete zone")}},V=async s=>{ie(s),await I(s.name,s.network),Pe(!0)},De=(s,a)=>{ie(s),a?(de(a),xe(a.name),me(a.type),he(a.value),ge(a.comment||""),ye(a.enabled)):(de(null),xe(""),me("A"),he(""),ge(""),ye(!0)),N(null),Oe(!0)},q=()=>{Pe(!1),ie(null),Be([])},_e=()=>{Oe(!1),de(null),N(null),i&&I(i.name,i.network)},fs=async()=>{if(i){N(null),j(!0);try{if(!S.trim()){N("Record name is required"),j(!1);return}if(!_.trim()){N("Record value is required"),j(!1);return}if(oe){const s={name:S.trim(),type:D,value:_.trim(),comment:ue.trim()||null,enabled:je};await o.updateDnsRecord(oe.name,i.network,i.name,s)}else{const s={name:S.trim(),type:D,value:_.trim(),comment:ue.trim()||null,enabled:je};await o.createDnsRecord(i.name,i.network,s)}await I(i.name,i.network),_e()}catch(s){N(s?.response?.data?.detail||s.message||"Failed to save record")}finally{j(!1)}}},vs=async()=>{if(!(!Ne||!i))try{await o.deleteDnsRecord(Ne.name,i.network,i.name),await I(i.name,i.network),H(!1),fe(null)}catch(s){h(s?.response?.data?.detail||s.message||"Failed to delete record")}};return rs?e.jsx("div",{className:"flex h-screen items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Loading DNS zones..."})]})}):e.jsxs("div",{className:"flex h-screen",children:[e.jsx(Cs,{onLogout:js,isOpen:He,onClose:()=>Re(!1)}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(Ss,{hostname:"nixos-router",username:ts,connectionStatus:us,onMenuClick:()=>Re(!He)}),e.jsx("main",{className:"flex-1 overflow-y-auto p-6 bg-gray-50 dark:bg-gray-900",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(bs,{className:"w-8 h-8 text-gray-900 dark:text-white"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"DNS Management"})]})}),Fe&&e.jsx(d,{color:"failure",className:"mb-6",onDismiss:()=>h(null),children:Fe}),e.jsxs(Ge,{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"HOMELAB"}),(()=>{const s=Q.homelab,l=Te?.startsWith("homelab-");return e.jsxs("div",{className:"flex gap-2 items-center flex-wrap",children:[s&&e.jsx(x,{color:s.is_active?"success":"gray",size:"sm",children:s.is_active?"Running":s.is_enabled?"Stopped":"Disabled"}),e.jsx(n,{size:"xs",color:"success",onClick:()=>u("homelab","start"),disabled:l||(s?.is_active??!1),title:"Start Service",children:e.jsx(Je,{className:"w-4 h-4"})}),e.jsx(n,{size:"xs",color:"failure",onClick:()=>u("homelab","stop"),disabled:l||!(s?.is_active??!1),title:"Stop Service",children:e.jsx(Ue,{className:"w-4 h-4"})}),e.jsx(n,{size:"xs",color:"warning",onClick:()=>u("homelab","reload"),disabled:l||!(s?.is_active??!1),title:"Reload Service",children:e.jsx($,{className:"w-4 h-4"})}),e.jsx(n,{size:"xs",color:"purple",onClick:()=>u("homelab","restart"),disabled:l,title:"Restart Service",children:e.jsx($,{className:"w-4 h-4"})})]})})()]}),e.jsx(n,{color:"blue",onClick:()=>f(void 0,"homelab"),children:"New Zone"})]}),P&&e.jsx("div",{className:"mb-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(es,{className:"w-5 h-5 text-gray-500 dark:text-gray-400 mt-1 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:"Domain Hosting Mode"}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(ss,{checked:P.forward_unlisted,onChange:s=>Xe("homelab",s),disabled:Ke,label:""}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:P.forward_unlisted?"Partially Hosted":"Fully Hosted"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:P.forward_unlisted?"Serve configured records locally; look up unlisted names via upstream DNS":"Only serve configured records; unlisted names get no answer (NXDOMAIN)"})]})]}),B&&e.jsx(d,{color:"info",className:"mt-2",icon:b,children:e.jsx("span",{className:"text-xs",children:B})})]})]})}),(()=>{const s=Ee.filter(a=>a.network==="homelab");return s.length===0?e.jsx(d,{color:"info",icon:b,children:"No DNS zones configured for HOMELAB. Create a zone to get started."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden min-[1000px]:block overflow-x-auto",children:e.jsxs(t,{children:[e.jsxs(t.Head,{children:[e.jsx(t.HeadCell,{children:"Name"}),e.jsx(t.HeadCell,{children:"Authoritative"}),e.jsx(t.HeadCell,{children:"Forward To"}),e.jsx(t.HeadCell,{children:"Delegate To"}),e.jsx(t.HeadCell,{children:"Status"}),e.jsx(t.HeadCell,{children:"Actions"})]}),e.jsx(t.Body,{className:"divide-y",children:s.map(a=>e.jsxs(t.Row,{className:"bg-white dark:border-gray-700 dark:bg-gray-800",children:[e.jsx(t.Cell,{className:"whitespace-nowrap font-medium text-gray-900 dark:text-white",children:a.name}),e.jsx(t.Cell,{children:e.jsx(x,{color:a.authoritative?"success":"gray",children:a.authoritative?"Yes":"No"})}),e.jsx(t.Cell,{className:"text-gray-500 dark:text-gray-400",children:a.forward_to||"-"}),e.jsx(t.Cell,{className:"text-gray-500 dark:text-gray-400",children:a.delegate_to||"-"}),e.jsx(t.Cell,{children:(()=>{const l=L(a);return e.jsx(x,{color:l.is_active?"success":"gray",children:l.is_active?"Running":l.is_enabled?"Stopped":"Disabled"})})()}),e.jsx(t.Cell,{children:e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(n,{size:"xs",color:"blue",onClick:()=>V(a),children:"Records"}),e.jsx(n,{size:"xs",color:"gray",onClick:()=>f(a),children:e.jsx(g,{className:"w-4 h-4"})}),e.jsx(n,{size:"xs",color:"failure",onClick:()=>{R(a),y(!0)},children:e.jsx(p,{className:"w-4 h-4"})})]})})]},a.id))})]})}),e.jsx("div",{className:"min-[1000px]:hidden space-y-3",children:s.map(a=>{const l=L(a);return e.jsxs("div",{className:"p-4 rounded-lg border bg-white border-gray-200 dark:bg-gray-800 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"font-semibold text-lg mb-1 text-gray-900 dark:text-white",children:a.name})}),e.jsx(x,{color:l.is_active?"success":"gray",size:"sm",children:l.is_active?"Running":l.is_enabled?"Stopped":"Disabled"})]}),e.jsxs("div",{className:"space-y-2 text-sm mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Authoritative:"}),e.jsx(x,{color:a.authoritative?"success":"gray",size:"sm",children:a.authoritative?"Yes":"No"})]}),a.forward_to&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Forward To:"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100 font-mono text-xs",children:a.forward_to})]}),a.delegate_to&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Delegate To:"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100 font-mono text-xs",children:a.delegate_to})]})]}),e.jsx("div",{className:"pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex gap-2 mb-2 flex-wrap",children:[e.jsx(n,{size:"xs",color:"blue",onClick:()=>V(a),className:"flex-1 min-w-[80px]",children:"Records"}),e.jsx(n,{size:"xs",color:"gray",onClick:()=>f(a),className:"flex-1 min-w-[80px]",children:e.jsx(g,{className:"w-4 h-4"})}),e.jsx(n,{size:"xs",color:"failure",onClick:()=>{R(a),y(!0)},className:"flex-1 min-w-[80px]",children:e.jsx(p,{className:"w-4 h-4"})})]})})]},a.id)})})]})})(),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Dynamic DNS (DHCP clients)"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:["Read-only entries from DHCP leases. Configure ",e.jsx("code",{className:"bg-gray-100 dark:bg-gray-700 px-1 rounded",children:"dynamic_domain"})," in DHCP for this network to enable."]}),Z&&e.jsx(d,{color:"failure",className:"mb-4",onDismiss:()=>z(null),children:Z}),Ie?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loading…"}):(()=>{const s=ve.find(l=>l.network==="homelab")?.dynamic_domain??null,a=Le.homelab;return!s||s===""?e.jsxs(d,{color:"info",icon:b,children:["Dynamic DNS is disabled for this network. Set ",e.jsx("code",{className:"bg-gray-100 dark:bg-gray-700 px-1 rounded",children:"dynamic_domain"})," in DHCP to enable."]}):a.length===0?e.jsx(d,{color:"info",children:"No dynamic DNS entries. Entries appear when DHCP clients have active leases."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(t,{children:[e.jsxs(t.Head,{children:[e.jsx(t.HeadCell,{children:"Hostname"}),e.jsx(t.HeadCell,{children:"FQDN"}),e.jsx(t.HeadCell,{children:"IP address"}),e.jsx(t.HeadCell,{children:"MAC"}),e.jsx(t.HeadCell,{children:"Actions"})]}),e.jsx(t.Body,{className:"divide-y",children:a.map((l,v)=>e.jsxs(t.Row,{className:"bg-white dark:border-gray-700 dark:bg-gray-800",children:[e.jsx(t.Cell,{className:"font-medium text-gray-900 dark:text-white",children:l.hostname}),e.jsx(t.Cell,{className:"text-gray-500 dark:text-gray-400 font-mono text-sm",children:l.hostname_fqdn}),e.jsx(t.Cell,{className:"text-gray-900 dark:text-white font-mono text-sm",children:l.ip_address}),e.jsx(t.Cell,{className:"text-gray-500 dark:text-gray-400 font-mono text-sm",children:l.mac_address}),e.jsx(t.Cell,{children:e.jsx(n,{size:"xs",color:"gray",onClick:()=>{be(l),we("homelab")},title:"Edit hostname",children:e.jsx(g,{className:"w-4 h-4"})})})]},`${l.mac_address}-${v}`))})]})})})()]})]}),e.jsxs(Ge,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"LAN"}),(()=>{const s=Q.lan,l=Te?.startsWith("lan-");return e.jsxs("div",{className:"flex gap-2 items-center flex-wrap",children:[s&&e.jsx(x,{color:s.is_active?"success":"gray",size:"sm",children:s.is_active?"Running":s.is_enabled?"Stopped":"Disabled"}),e.jsx(n,{size:"xs",color:"success",onClick:()=>u("lan","start"),disabled:l||(s?.is_active??!1),title:"Start Service",children:e.jsx(Je,{className:"w-4 h-4"})}),e.jsx(n,{size:"xs",color:"failure",onClick:()=>u("lan","stop"),disabled:l||!(s?.is_active??!1),title:"Stop Service",children:e.jsx(Ue,{className:"w-4 h-4"})}),e.jsx(n,{size:"xs",color:"warning",onClick:()=>u("lan","reload"),disabled:l||!(s?.is_active??!1),title:"Reload Service",children:e.jsx($,{className:"w-4 h-4"})}),e.jsx(n,{size:"xs",color:"purple",onClick:()=>u("lan","restart"),disabled:l,title:"Restart Service",children:e.jsx($,{className:"w-4 h-4"})})]})})()]}),e.jsx(n,{color:"blue",onClick:()=>f(void 0,"lan"),children:"New Zone"})]}),O&&e.jsx("div",{className:"mb-4 p-4 bg-gray-50 dark:bg-gray-700 rounded-lg border border-gray-200 dark:border-gray-600",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(es,{className:"w-5 h-5 text-gray-500 dark:text-gray-400 mt-1 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 dark:text-white mb-2",children:"Domain Hosting Mode"}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(ss,{checked:O.forward_unlisted,onChange:s=>Xe("lan",s),disabled:Ke,label:""}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:O.forward_unlisted?"Partially Hosted":"Fully Hosted"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:O.forward_unlisted?"Serve configured records locally; look up unlisted names via upstream DNS":"Only serve configured records; unlisted names get no answer (NXDOMAIN)"})]})]}),B&&e.jsx(d,{color:"info",className:"mt-2",icon:b,children:e.jsx("span",{className:"text-xs",children:B})})]})]})}),(()=>{const s=Ee.filter(a=>a.network==="lan");return s.length===0?e.jsx(d,{color:"info",icon:b,children:"No DNS zones configured for LAN. Create a zone to get started."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden min-[1000px]:block overflow-x-auto",children:e.jsxs(t,{children:[e.jsxs(t.Head,{children:[e.jsx(t.HeadCell,{children:"Name"}),e.jsx(t.HeadCell,{children:"Authoritative"}),e.jsx(t.HeadCell,{children:"Forward To"}),e.jsx(t.HeadCell,{children:"Delegate To"}),e.jsx(t.HeadCell,{children:"Status"}),e.jsx(t.HeadCell,{children:"Actions"})]}),e.jsx(t.Body,{className:"divide-y",children:s.map(a=>e.jsxs(t.Row,{className:"bg-white dark:border-gray-700 dark:bg-gray-800",children:[e.jsx(t.Cell,{className:"whitespace-nowrap font-medium text-gray-900 dark:text-white",children:a.name}),e.jsx(t.Cell,{children:e.jsx(x,{color:a.authoritative?"success":"gray",children:a.authoritative?"Yes":"No"})}),e.jsx(t.Cell,{className:"text-gray-500 dark:text-gray-400",children:a.forward_to||"-"}),e.jsx(t.Cell,{className:"text-gray-500 dark:text-gray-400",children:a.delegate_to||"-"}),e.jsx(t.Cell,{children:(()=>{const l=L(a);return e.jsx(x,{color:l.is_active?"success":"gray",children:l.is_active?"Running":l.is_enabled?"Stopped":"Disabled"})})()}),e.jsx(t.Cell,{children:e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(n,{size:"xs",color:"blue",onClick:()=>V(a),children:"Records"}),e.jsx(n,{size:"xs",color:"gray",onClick:()=>f(a),children:e.jsx(g,{className:"w-4 h-4"})}),e.jsx(n,{size:"xs",color:"failure",onClick:()=>{R(a),y(!0)},children:e.jsx(p,{className:"w-4 h-4"})})]})})]},a.id))})]})}),e.jsx("div",{className:"min-[1000px]:hidden space-y-3",children:s.map(a=>{const l=L(a);return e.jsxs("div",{className:"p-4 rounded-lg border bg-white border-gray-200 dark:bg-gray-800 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"font-semibold text-lg mb-1 text-gray-900 dark:text-white",children:a.name})}),e.jsx(x,{color:l.is_active?"success":"gray",size:"sm",children:l.is_active?"Running":l.is_enabled?"Stopped":"Disabled"})]}),e.jsxs("div",{className:"space-y-2 text-sm mb-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Authoritative:"}),e.jsx(x,{color:a.authoritative?"success":"gray",size:"sm",children:a.authoritative?"Yes":"No"})]}),a.forward_to&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Forward To:"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100 font-mono text-xs",children:a.forward_to})]}),a.delegate_to&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Delegate To:"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100 font-mono text-xs",children:a.delegate_to})]})]}),e.jsx("div",{className:"pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex gap-2 mb-2 flex-wrap",children:[e.jsx(n,{size:"xs",color:"blue",onClick:()=>V(a),className:"flex-1 min-w-[80px]",children:"Records"}),e.jsx(n,{size:"xs",color:"gray",onClick:()=>f(a),className:"flex-1 min-w-[80px]",children:e.jsx(g,{className:"w-4 h-4"})}),e.jsx(n,{size:"xs",color:"failure",onClick:()=>{R(a),y(!0)},className:"flex-1 min-w-[80px]",children:e.jsx(p,{className:"w-4 h-4"})})]})})]},a.id)})})]})})(),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"Dynamic DNS (DHCP clients)"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:["Read-only entries from DHCP leases. Configure ",e.jsx("code",{className:"bg-gray-100 dark:bg-gray-700 px-1 rounded",children:"dynamic_domain"})," in DHCP for this network to enable."]}),Z&&e.jsx(d,{color:"failure",className:"mb-4",onDismiss:()=>z(null),children:Z}),Ie?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Loading…"}):(()=>{const s=ve.find(l=>l.network==="lan")?.dynamic_domain??null,a=Le.lan;return!s||s===""?e.jsxs(d,{color:"info",icon:b,children:["Dynamic DNS is disabled for this network. Set ",e.jsx("code",{className:"bg-gray-100 dark:bg-gray-700 px-1 rounded",children:"dynamic_domain"})," in DHCP to enable."]}):a.length===0?e.jsx(d,{color:"info",children:"No dynamic DNS entries. Entries appear when DHCP clients have active leases."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(t,{children:[e.jsxs(t.Head,{children:[e.jsx(t.HeadCell,{children:"Hostname"}),e.jsx(t.HeadCell,{children:"FQDN"}),e.jsx(t.HeadCell,{children:"IP address"}),e.jsx(t.HeadCell,{children:"MAC"}),e.jsx(t.HeadCell,{children:"Actions"})]}),e.jsx(t.Body,{className:"divide-y",children:a.map((l,v)=>e.jsxs(t.Row,{className:"bg-white dark:border-gray-700 dark:bg-gray-800",children:[e.jsx(t.Cell,{className:"font-medium text-gray-900 dark:text-white",children:l.hostname}),e.jsx(t.Cell,{className:"text-gray-500 dark:text-gray-400 font-mono text-sm",children:l.hostname_fqdn}),e.jsx(t.Cell,{className:"text-gray-900 dark:text-white font-mono text-sm",children:l.ip_address}),e.jsx(t.Cell,{className:"text-gray-500 dark:text-gray-400 font-mono text-sm",children:l.mac_address}),e.jsx(t.Cell,{children:e.jsx(n,{size:"xs",color:"gray",onClick:()=>{be(l),we("lan")},title:"Edit hostname",children:e.jsx(g,{className:"w-4 h-4"})})})]},`${l.mac_address}-${v}`))})]})})})()]})]}),E&&pe&&e.jsx(Ds,{show:!!E,onClose:()=>{be(null),we(null)},currentHostname:E.hostname,dynamicDomain:ve.find(s=>s.network===pe)?.dynamic_domain??null,network:pe,macAddress:E.mac_address,ipAddress:E.ip_address,onSaved:Qe}),e.jsxs(c,{show:is,onClose:Se,size:"lg",children:[e.jsx(c.Header,{children:A?"Edit DNS Zone":"Create DNS Zone"}),e.jsx(c.Body,{className:"max-h-[70vh] overflow-y-auto",children:e.jsxs("div",{className:"space-y-4",children:[ze&&e.jsx(d,{color:"failure",children:ze}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"zoneName",value:"Zone Name *"}),e.jsx(w,{id:"zoneName",value:k,onChange:s=>X(s.target.value),placeholder:"example.com",required:!0,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"zoneNetwork",value:"Network *"}),e.jsxs(as,{id:"zoneNetwork",value:G,onChange:s=>J(s.target.value),className:"mt-1",children:[e.jsx("option",{value:"homelab",children:"HOMELAB"}),e.jsx("option",{value:"lan",children:"LAN"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"zoneAuthoritative",checked:U,onChange:s=>ee(s.target.checked),className:"w-4 h-4"}),e.jsx(m,{htmlFor:"zoneAuthoritative",value:"Authoritative (serve locally)"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"zoneForwardTo",value:"Forward To (optional)"}),e.jsx(w,{id:"zoneForwardTo",value:se,onChange:s=>ae(s.target.value),placeholder:"192.168.1.1",className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"zoneDelegateTo",value:"Delegate To (optional)"}),e.jsx(w,{id:"zoneDelegateTo",value:te,onChange:s=>le(s.target.value),placeholder:"ns1.example.com",className:"mt-1"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"zoneEnabled",checked:re,onChange:s=>ne(s.target.checked),className:"w-4 h-4"}),e.jsx(m,{htmlFor:"zoneEnabled",value:"Enabled"})]})]})}),e.jsxs(c.Footer,{children:[e.jsx(n,{color:"blue",onClick:ys,disabled:F||!k.trim(),children:F?"Saving...":"Save"}),e.jsx(n,{color:"gray",onClick:Se,children:"Cancel"})]})]}),e.jsxs(c,{show:cs,onClose:q,size:"4xl",children:[e.jsx(c.Header,{children:i?`${i.network.toUpperCase()} DNS Records - ${i.name}`:"DNS Records"}),e.jsx(c.Body,{className:"max-h-[80vh] overflow-y-auto",children:e.jsxs("div",{className:"space-y-4",children:[T&&e.jsx(d,{color:"failure",children:T}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Records"}),i&&e.jsxs(n,{size:"sm",color:"blue",onClick:()=>De(i),children:[e.jsx(ps,{className:"w-4 h-4 mr-1"}),"Add Record"]})]}),ce.length===0?e.jsx(d,{color:"info",children:"No records in this zone. Add a record to get started."}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden min-[1000px]:block overflow-x-auto",children:e.jsxs(t,{children:[e.jsxs(t.Head,{children:[e.jsx(t.HeadCell,{children:"Name"}),e.jsx(t.HeadCell,{children:"Type"}),e.jsx(t.HeadCell,{children:"Value"}),e.jsx(t.HeadCell,{children:"Comment"}),e.jsx(t.HeadCell,{children:"Status"}),e.jsx(t.HeadCell,{children:"Actions"})]}),e.jsx(t.Body,{className:"divide-y",children:ce.map(s=>e.jsxs(t.Row,{className:"bg-white dark:border-gray-700 dark:bg-gray-800",children:[e.jsx(t.Cell,{className:"font-medium text-gray-900 dark:text-white",children:s.name}),e.jsx(t.Cell,{children:e.jsx(x,{color:s.type==="A"?"blue":"purple",children:s.type})}),e.jsx(t.Cell,{className:"font-mono text-sm text-gray-900 dark:text-white",children:s.value}),e.jsx(t.Cell,{className:"text-gray-500 dark:text-gray-400",children:s.comment||"-"}),e.jsx(t.Cell,{children:e.jsx(x,{color:s.enabled?"success":"gray",children:s.enabled?"Enabled":"Disabled"})}),e.jsx(t.Cell,{children:e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsx(n,{size:"xs",color:"gray",onClick:()=>{q(),De(i,s)},children:e.jsx(g,{className:"w-4 h-4"})}),e.jsx(n,{size:"xs",color:"failure",onClick:()=>{fe(s),H(!0)},children:e.jsx(p,{className:"w-4 h-4"})})]})})]},s.id))})]})}),e.jsx("div",{className:"min-[1000px]:hidden space-y-3",children:ce.map(s=>e.jsxs("div",{className:"p-3 rounded-lg border bg-white border-gray-200 dark:bg-gray-800 dark:border-gray-700",children:[e.jsx("div",{className:"flex justify-between items-start mb-2",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:s.name}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(x,{color:s.type==="A"?"blue":"purple",size:"sm",children:s.type}),e.jsx(x,{color:s.enabled?"success":"gray",size:"sm",children:s.enabled?"Enabled":"Disabled"})]})]})}),e.jsxs("div",{className:"space-y-1 text-sm mb-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Value:"}),e.jsx("span",{className:"font-mono text-xs text-gray-900 dark:text-gray-100 break-all",children:s.value})]}),s.comment&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Comment:"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100 text-xs",children:s.comment})]})]}),e.jsxs("div",{className:"pt-2 border-t border-gray-200 dark:border-gray-700 flex gap-2",children:[e.jsx(n,{size:"xs",color:"gray",onClick:()=>{q(),De(i,s)},className:"flex-1",children:e.jsx(g,{className:"w-4 h-4"})}),e.jsx(n,{size:"xs",color:"failure",onClick:()=>{fe(s),H(!0)},className:"flex-1",children:e.jsx(p,{className:"w-4 h-4"})})]})]},s.id))})]})]})}),e.jsx(c.Footer,{children:e.jsx(n,{color:"gray",onClick:q,children:"Close"})})]}),e.jsxs(c,{show:os,onClose:_e,size:"lg",children:[e.jsx(c.Header,{children:oe?"Edit DNS Record":"Create DNS Record"}),e.jsx(c.Body,{className:"max-h-[70vh] overflow-y-auto",children:e.jsxs("div",{className:"space-y-4",children:[T&&e.jsx(d,{color:"failure",children:T}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"recordName",value:"Record Name *"}),e.jsx(w,{id:"recordName",value:S,onChange:s=>xe(s.target.value),placeholder:"hostname.example.com",required:!0,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"recordType",value:"Record Type *"}),e.jsxs(as,{id:"recordType",value:D,onChange:s=>me(s.target.value),className:"mt-1",children:[e.jsx("option",{value:"A",children:"A (IPv4 Address)"}),e.jsx("option",{value:"CNAME",children:"CNAME (Alias)"})]})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"recordValue",value:D==="A"?"IP Address *":"Target Hostname *"}),e.jsx(w,{id:"recordValue",value:_,onChange:s=>he(s.target.value),placeholder:D==="A"?"192.168.1.1":"target.example.com",required:!0,className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"recordComment",value:"Comment (optional)"}),e.jsx(w,{id:"recordComment",value:ue,onChange:s=>ge(s.target.value),className:"mt-1"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"recordEnabled",checked:je,onChange:s=>ye(s.target.checked),className:"w-4 h-4"}),e.jsx(m,{htmlFor:"recordEnabled",value:"Enabled"})]})]})}),e.jsxs(c.Footer,{children:[e.jsx(n,{color:"blue",onClick:fs,disabled:F||!S.trim()||!_.trim(),children:F?"Saving...":"Save"}),e.jsx(n,{color:"gray",onClick:_e,children:"Cancel"})]})]}),e.jsxs(c,{show:ds,onClose:()=>y(!1),size:"md",children:[e.jsx(c.Header,{children:"Delete Zone"}),e.jsx(c.Body,{children:e.jsxs("p",{className:"text-gray-700 dark:text-gray-300",children:["Are you sure you want to delete zone ",e.jsx("strong",{children:M?.name}),"? This will also delete all records in this zone."]})}),e.jsxs(c.Footer,{children:[e.jsx(n,{color:"failure",onClick:Ns,children:"Delete"}),e.jsx(n,{color:"gray",onClick:()=>y(!1),children:"Cancel"})]})]}),e.jsxs(c,{show:xs,onClose:()=>H(!1),size:"md",children:[e.jsx(c.Header,{children:"Delete Record"}),e.jsx(c.Body,{children:e.jsxs("p",{className:"text-gray-700 dark:text-gray-300",children:["Are you sure you want to delete record ",e.jsx("strong",{children:Ne?.name}),"?"]})}),e.jsxs(c.Footer,{children:[e.jsx(n,{color:"failure",onClick:vs,children:"Delete"}),e.jsx(n,{color:"gray",onClick:()=>H(!1),children:"Cancel"})]})]})]})})]})]})}export{Ts as Dns};
