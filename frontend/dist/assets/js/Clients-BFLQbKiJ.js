import{j as e,a as g,C as be,T as ke,H as we,S as ae,b as t,c as Ne,d as b,B as m,M as J,e as _e}from"./ui-vendor-zVfStxq8.js";import{u as Ce,r as x}from"./react-vendor-DKKOAuGG.js";import{u as Se,S as ve,N as De}from"./useMetrics-BlPE0wYs.js";import{a as A}from"./index-lF-TnUB9.js";import"./http-vendor-B9ygI19o.js";function Oe(){const d=localStorage.getItem("access_token"),re=localStorage.getItem("username")||"Unknown",N=Ce(),[k,te]=x.useState(""),[C,ne]=x.useState("all"),[S,le]=x.useState("all"),[h,B]=x.useState("all"),[v,w]=x.useState([]),[oe,u]=x.useState([]),[ce,f]=x.useState([]),[Y,q]=x.useState(!1),[$,ie]=x.useState("ip"),[F,G]=x.useState("asc"),[de,D]=x.useState(!1),[c,M]=x.useState(null),[L,I]=x.useState(null),[xe,E]=x.useState(new Map),[me,P]=x.useState(!1),{connectionStatus:he}=Se(d),pe=async()=>{await A.logout(),N("/login")},K=async s=>{if(d)try{P(!0),I(s);const a=await A.getDevicePortScan(s);M(a),E(r=>new Map(r).set(s.toLowerCase(),a.scan_status)),D(!0)}catch(a){a.response?.status===404?(I(s),M(null),D(!0)):(console.error("Failed to fetch port scan:",a),alert("Failed to load port scan results"))}finally{P(!1)}},z=async s=>{if(d)try{P(!0);const a=await A.triggerDevicePortScan(s);a.status==="queued"||a.status==="in_progress"?(E(r=>new Map(r).set(s.toLowerCase(),"pending")),setTimeout(()=>{K(s)},2e3)):alert(a.message||"Failed to trigger scan")}catch(a){console.error("Failed to trigger port scan:",a),alert("Failed to trigger port scan")}finally{P(!1)}},Q=s=>{const a=s.mac_address.toLowerCase(),r=xe.get(a),n=r==="pending"||r==="in_progress",o=r==="completed",l=r==="failed";return s.is_online?n?e.jsx(b,{content:"Port scan in progress",children:e.jsxs(m,{size:"xs",color:"gray",disabled:!0,children:[e.jsx(_e,{className:"w-3 h-3 mr-1"}),"Scanning..."]})}):l?e.jsx(b,{content:"Last scan failed - click to retry",children:e.jsx(m,{size:"xs",color:"failure",onClick:()=>z(s.mac_address),children:"Ports (Failed)"})}):e.jsx(b,{content:o?"View port scan results":"Scan ports",children:e.jsxs(m,{size:"xs",color:"gray",onClick:()=>{o?K(s.mac_address):z(s.mac_address)},children:["Ports",o&&c?` (${c.ports.length})`:""]})}):e.jsx(b,{content:"Device is offline",children:e.jsx(m,{size:"xs",color:"gray",disabled:!0,children:"Ports"})})};x.useEffect(()=>{const s=async()=>{if(d)try{const r=await fetch("/api/devices/all",{headers:{Authorization:`Bearer ${d}`}});if(r.ok){const n=await r.json();w(n);const o=n.filter(p=>p.is_online),l=new Map,i=10;for(let p=0;p<o.length;p+=i){const R=o.slice(p,p+i);await Promise.allSettled(R.map(async V=>{try{const O=await A.getDevicePortScan(V.mac_address);l.set(V.mac_address.toLowerCase(),O.scan_status)}catch(O){O.response?.status!==404&&console.debug(`Failed to fetch port scan for ${V.mac_address}:`,O)}}))}E(l)}}catch(r){console.error("Failed to fetch devices:",r)}};s();const a=setInterval(s,1e4);return()=>clearInterval(a)},[d]),x.useEffect(()=>{const s=async()=>{if(d)try{const r=await fetch("/api/devices/blocked",{headers:{Authorization:`Bearer ${d}`}});if(r.ok){const n=await r.json();u(n.ipv4||[]),f((n.macs||[]).map(o=>o.toLowerCase()))}}catch{}};s();const a=setInterval(s,1e4);return()=>clearInterval(a)},[d]);const _=s=>s.mac_address&&ce.includes(s.mac_address.toLowerCase())?!0:s.ip_address&&oe.includes(s.ip_address),W=async s=>{if(!d)return;const a=!s.favorite;w(r=>r.map(n=>n.mac_address===s.mac_address?{...n,favorite:a}:n));try{await fetch("/api/devices/override",{method:"POST",headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"},body:JSON.stringify({mac_address:s.mac_address,favorite:a})});const r=await fetch("/api/devices/all",{headers:{Authorization:`Bearer ${d}`}});r.ok&&w(await r.json())}catch{w(r=>r.map(n=>n.mac_address===s.mac_address?{...n,favorite:!a}:n))}},X=async s=>{if(!d)return;const a=s.nickname||"",r=window.prompt("Set nickname for this device:",a);if(r!==null){w(n=>n.map(o=>o.mac_address===s.mac_address?{...o,nickname:r}:o));try{await fetch("/api/devices/override",{method:"POST",headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"},body:JSON.stringify({mac_address:s.mac_address,nickname:r})});const n=await fetch("/api/devices/all",{headers:{Authorization:`Bearer ${d}`}});n.ok&&w(await n.json())}catch{}}},Z=async s=>{if(!d)return;const a=_(s),r=a?"/api/devices/unblock":"/api/devices/block",n={mac_address:s.mac_address};s.ip_address&&s.ip_address.includes(".")&&(n.ip_address=s.ip_address),a?(s.ip_address&&u(o=>o.filter(l=>l!==s.ip_address)),f(o=>o.filter(l=>l!==s.mac_address.toLowerCase()))):(f(o=>Array.from(new Set([...o,s.mac_address.toLowerCase()]))),n.ip_address&&u(o=>Array.from(new Set([...o,n.ip_address]))));try{if((await fetch(r,{method:"POST",headers:{Authorization:`Bearer ${d}`,"Content-Type":"application/json"},body:JSON.stringify(n)})).ok){await new Promise(i=>setTimeout(i,100));const l=await fetch("/api/devices/blocked",{headers:{Authorization:`Bearer ${d}`}});if(l.ok){const i=await l.json();u(i.ipv4||[]),f((i.macs||[]).map(p=>p.toLowerCase()))}else console.warn("Failed to refetch blocked list after block/unblock operation")}else a?(s.ip_address&&u(l=>Array.from(new Set([...l,s.ip_address]))),f(l=>Array.from(new Set([...l,s.mac_address.toLowerCase()])))):(s.ip_address&&u(l=>l.filter(i=>i!==s.ip_address)),f(l=>l.filter(i=>i!==s.mac_address.toLowerCase())))}catch{a?(s.ip_address&&u(l=>Array.from(new Set([...l,s.ip_address]))),f(l=>Array.from(new Set([...l,s.mac_address.toLowerCase()])))):(s.ip_address&&u(l=>l.filter(i=>i!==s.ip_address)),f(l=>l.filter(i=>i!==s.mac_address.toLowerCase())))}},ge=v.filter(s=>{const a=!k||s.hostname?.toLowerCase().includes(k.toLowerCase())||s.ip_address.includes(k)||s.mac_address.includes(k)||s.vendor?.toLowerCase().includes(k.toLowerCase()),r=C==="all"||C==="online"&&s.is_online||C==="offline"&&!s.is_online,n=S==="all"||S==="dhcp"&&s.is_dhcp||S==="static"&&!s.is_dhcp,o=h==="all"||s.network===h;return a&&r&&n&&o}),U=h==="all"?v:v.filter(s=>s.network===h),ue=U.filter(s=>s.is_online).length,fe=U.filter(s=>!s.is_online).length,ee=U.length,T=s=>s.split(".").map(a=>a.padStart(3,"0")).join("."),j=s=>{$===s?G(F==="asc"?"desc":"asc"):(ie(s),G("asc"))},y=s=>$!==s?null:F==="asc"?" ↑":" ↓",se=s=>s.nickname||s.hostname||"Unknown",H=[...ge].sort((s,a)=>{let r=0;switch($){case"ip":const n=T(s.ip_address),o=T(a.ip_address);r=n.localeCompare(o);break;case"device":r=se(s).toLowerCase().localeCompare(se(a).toLowerCase());break;case"mac":r=s.mac_address.localeCompare(a.mac_address);break;case"vendor":const l=s.vendor||"￿",i=a.vendor||"￿";r=l.toLowerCase().localeCompare(i.toLowerCase());break;case"network":r=s.network.localeCompare(a.network);break;case"status":r=(a.is_online?1:0)-(s.is_online?1:0);break;case"type":r=(a.is_dhcp?1:0)-(s.is_dhcp?1:0);break;case"lastSeen":const p=new Date(s.last_seen).getTime(),R=new Date(a.last_seen).getTime();r=p-R;break;default:r=T(s.ip_address).localeCompare(T(a.ip_address))}return F==="asc"?r:-r}),je=s=>{const a=new Date(s),r=new Date,n=new Date(r.getFullYear(),r.getMonth(),r.getDate());if(new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime()===n.getTime())return a.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});{const l=(a.getMonth()+1).toString().padStart(2,"0"),i=a.getDate().toString().padStart(2,"0"),p=a.getFullYear().toString().slice(-2);return`${l}/${i}/${p}`}},ye=({text:s,maxLength:a=20})=>s.length<=a?e.jsx("span",{children:s}):e.jsx(b,{content:s,placement:"top",children:e.jsx("span",{className:"cursor-help truncate block max-w-[200px]",children:s})});return e.jsxs("div",{className:"flex h-screen",children:[e.jsx(ve,{onLogout:pe,isOpen:Y,onClose:()=>q(!1)}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(De,{hostname:"nixos-router",username:re,connectionStatus:he,onMenuClick:()=>q(!Y)}),e.jsxs("main",{className:"flex-1 overflow-y-auto p-4 md:p-6 bg-gray-50 dark:bg-gray-900",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-4 md:mb-6 gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:"Devices"}),e.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Showing ",H.length," of ",ee," devices",h!=="all"&&` (${h.toUpperCase()} network)`,e.jsxs("span",{className:"hidden sm:inline",children:[" • ","Auto-refreshing every 10 seconds"]})]})]}),e.jsxs("div",{className:"flex gap-2 md:gap-4",children:[e.jsxs(g,{color:"success",size:"sm",className:"md:text-base",children:[ue," Online"]}),e.jsxs(g,{color:"gray",size:"sm",className:"md:text-base",children:[fe," Offline"]}),e.jsxs(g,{color:"info",size:"sm",className:"md:text-base",children:[ee," Total"]})]})]}),e.jsxs(be,{children:[e.jsxs("div",{className:"min-[1000px]:sticky min-[1000px]:top-0 min-[1000px]:z-20 min-[1000px]:bg-white min-[1000px]:dark:bg-gray-800",children:[e.jsx("div",{className:"mb-4 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex space-x-1",role:"tablist",children:[e.jsx("button",{role:"tab","aria-selected":h==="all",onClick:()=>B("all"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${h==="all"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}`,children:"All Networks"}),e.jsx("button",{role:"tab","aria-selected":h==="homelab",onClick:()=>B("homelab"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${h==="homelab"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}`,children:"HOMELAB"}),e.jsx("button",{role:"tab","aria-selected":h==="lan",onClick:()=>B("lan"),className:`px-4 py-2 text-sm font-medium border-b-2 transition-colors ${h==="lan"?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300"}`,children:"LAN"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsx("div",{children:e.jsx(ke,{icon:we,placeholder:"Search...",value:k,onChange:s=>te(s.target.value)})}),e.jsx("div",{children:e.jsxs(ae,{value:C,onChange:s=>ne(s.target.value),children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"online",children:"Online Only"}),e.jsx("option",{value:"offline",children:"Offline Only"})]})}),e.jsx("div",{children:e.jsxs(ae,{value:S,onChange:s=>le(s.target.value),children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"dhcp",children:"DHCP Only"}),e.jsx("option",{value:"static",children:"Static Only"})]})})]})]}),e.jsxs("div",{className:"xl-custom:hidden mb-4 flex flex-wrap gap-4 text-xs text-gray-600 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:"Network:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{children:"HOMELAB"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-purple-500"}),e.jsx("span",{children:"LAN"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-semibold",children:"Type:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-500"}),e.jsx("span",{children:"Static"})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-yellow-500"}),e.jsx("span",{children:"DHCP"})]})]})]}),e.jsx("div",{className:"hidden min-[1000px]:block overflow-x-auto",children:e.jsxs(t,{children:[e.jsxs(t.Head,{children:[e.jsxs(t.HeadCell,{className:"cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>j("ip"),children:["IP Address",y("ip")]}),e.jsxs(t.HeadCell,{className:"cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>j("device"),children:["Device",y("device")]}),e.jsxs(t.HeadCell,{className:"hidden lg:table-cell cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>j("mac"),children:["MAC Address",y("mac")]}),e.jsxs(t.HeadCell,{className:"hidden xl:table-cell cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>j("vendor"),children:["Vendor",y("vendor")]}),e.jsxs(t.HeadCell,{className:"w-12 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>j("network"),children:["Network",y("network")]}),e.jsxs(t.HeadCell,{className:"w-12 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>j("status"),children:["Status",y("status")]}),e.jsxs(t.HeadCell,{className:"w-12 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>j("type"),children:["Type",y("type")]}),e.jsxs(t.HeadCell,{className:"w-24 cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700",onClick:()=>j("lastSeen"),children:["Last Seen",y("lastSeen")]}),e.jsx(t.HeadCell,{children:"Actions"})]}),e.jsx(t.Body,{className:"divide-y",children:H.map(s=>e.jsxs(t.Row,{className:s.is_online?"":"opacity-50",children:[e.jsx(t.Cell,{className:"font-mono text-sm",children:s.ip_address}),e.jsx(t.Cell,{className:"font-medium max-w-[200px]",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"text-yellow-500 hover:text-yellow-400 flex-shrink-0",title:s.favorite?"Unfavorite":"Favorite",onClick:()=>W(s),children:s.favorite?"★":"☆"}),e.jsx("button",{className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 flex-shrink-0",title:"Edit nickname",onClick:()=>X(s),children:e.jsx(Ne,{className:"w-4 h-4"})}),e.jsx(ye,{text:s.nickname||s.hostname||"Unknown",maxLength:20})]})}),e.jsx(t.Cell,{className:"font-mono text-sm hidden lg:table-cell",children:s.mac_address}),e.jsx(t.Cell,{className:"text-sm text-gray-600 hidden xl:table-cell",children:s.vendor||"—"}),e.jsxs(t.Cell,{children:[e.jsx("div",{className:"hidden xl-custom:block",children:e.jsx(g,{color:s.network==="homelab"?"info":"purple",size:"sm",children:s.network.toUpperCase()})}),e.jsx("div",{className:"xl-custom:hidden",children:e.jsx(b,{content:s.network.toUpperCase(),placement:"top",children:e.jsx("div",{className:`w-3 h-3 rounded-full ${s.network==="homelab"?"bg-blue-500":"bg-purple-500"}`})})})]}),e.jsxs(t.Cell,{children:[e.jsx("div",{className:"hidden xl-custom:block",children:e.jsx(g,{color:s.is_online?"success":"gray",size:"sm",children:s.is_online?"ONLINE":"OFFLINE"})}),e.jsx("div",{className:"xl-custom:hidden",children:e.jsx(b,{content:s.is_online?"Online":"Offline",placement:"top",children:e.jsx("div",{className:`w-3 h-3 rounded-full ${s.is_online?"bg-green-500":"bg-gray-400"}`})})})]}),e.jsxs(t.Cell,{children:[e.jsx("div",{className:"hidden xl-custom:block",children:e.jsx(g,{color:s.is_dhcp?"warning":"gray",size:"sm",children:s.is_dhcp?"DHCP":"Static"})}),e.jsx("div",{className:"xl-custom:hidden",children:e.jsx(b,{content:s.is_dhcp?"DHCP":"Static",placement:"top",children:e.jsx("div",{className:`w-3 h-3 rounded-full ${s.is_dhcp?"bg-yellow-500":"bg-gray-500"}`})})})]}),e.jsx(t.Cell,{className:"text-sm whitespace-nowrap",children:je(s.last_seen)}),e.jsx(t.Cell,{children:e.jsxs("div",{className:"flex gap-1 flex-wrap",children:[e.jsx(m,{size:"xs",color:"gray",onClick:()=>N(`/devices/by-mac/${s.mac_address}`),children:"Details"}),e.jsx(m,{size:"xs",color:"gray",onClick:()=>N(`/devices/${s.ip_address}`),children:"Usage"}),e.jsx(m,{size:"xs",color:_(s)?"success":"failure",onClick:()=>Z(s),children:_(s)?"Enable":"Disable"}),Q(s)]})})]},s.mac_address))})]})}),e.jsx("div",{className:"min-[1000px]:hidden space-y-3",children:H.map(s=>e.jsxs("div",{className:`p-4 rounded-lg border ${s.is_online?"bg-white border-gray-200 dark:bg-gray-800 dark:border-gray-700":"bg-gray-50 border-gray-200 dark:bg-gray-900 dark:border-gray-700 opacity-60"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-lg mb-1",children:s.hostname||"Unknown"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.ip_address})]}),e.jsx(g,{color:s.is_online?"success":"gray",size:"sm",children:s.is_online?"● Online":"○ Offline"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"MAC:"}),e.jsx("span",{className:"font-mono",children:s.mac_address})]}),s.vendor&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Vendor:"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:s.vendor})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"Network:"}),e.jsx(g,{color:s.network==="homelab"?"info":"purple",size:"sm",children:s.network.toUpperCase()})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"Nickname:"}),e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:s.nickname||"—"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-500",children:"Type:"}),e.jsx(g,{color:s.is_dhcp?s.is_static?"success":"warning":"gray",size:"sm",children:s.is_static?"Static DHCP":s.is_dhcp?"Dynamic":"Static IP"})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 pt-1 border-t border-gray-200 dark:border-gray-700",children:[e.jsx("span",{children:"Last seen:"}),e.jsx("span",{children:new Date(s.last_seen).toLocaleString()})]}),e.jsxs("div",{className:"pt-3",children:[e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx(m,{size:"xs",color:"gray",onClick:()=>N(`/devices/by-mac/${s.mac_address}`),className:"flex-1",children:"Details"}),e.jsx(m,{size:"xs",color:"gray",onClick:()=>N(`/devices/${s.ip_address}`),className:"flex-1",children:"Usage"}),e.jsx(m,{size:"xs",color:_(s)?"success":"failure",onClick:()=>Z(s),className:"flex-1",children:_(s)?"Enable":"Disable"})]}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx(m,{size:"xs",color:"light",className:"flex-1",onClick:()=>X(s),children:"Edit Nickname"}),e.jsx(m,{size:"xs",color:s.favorite?"warning":"light",onClick:()=>W(s),children:s.favorite?"★ Favorite":"☆ Favorite"})]}),e.jsx("div",{className:"mt-2",children:Q(s)})]})]})]},s.mac_address))}),H.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No devices found matching your filters"})]}),e.jsxs(J,{show:de,onClose:()=>{D(!1),M(null),I(null)},size:"xl",children:[e.jsxs(J.Header,{children:["Port Scan Results",c?e.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:[c.mac_address," (",c.ip_address,")"]}):L?e.jsx("span",{className:"ml-2 text-sm text-gray-500",children:L}):null]}),e.jsx(J.Body,{children:me?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-gray-100"}),e.jsx("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Loading port scan results..."})]}):c?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(g,{color:c.scan_status==="completed"?"success":c.scan_status==="failed"?"failure":c.scan_status==="in_progress"?"warning":"gray",children:c.scan_status.toUpperCase()}),e.jsxs("span",{className:"ml-2 text-sm text-gray-600 dark:text-gray-400",children:["Started: ",new Date(c.scan_started_at).toLocaleString()]}),c.scan_completed_at&&e.jsxs("span",{className:"ml-2 text-sm text-gray-600 dark:text-gray-400",children:["Completed: ",new Date(c.scan_completed_at).toLocaleString()]})]}),e.jsx(m,{size:"xs",color:"gray",onClick:()=>{c&&z(c.mac_address)},children:"Refresh Scan"})]}),c.error_message&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded",children:e.jsxs("p",{className:"text-sm text-red-800 dark:text-red-200",children:[e.jsx("strong",{children:"Error:"})," ",c.error_message]})}),c.ports.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(t,{children:[e.jsxs(t.Head,{children:[e.jsx(t.HeadCell,{children:"Port"}),e.jsx(t.HeadCell,{children:"Protocol"}),e.jsx(t.HeadCell,{children:"State"}),e.jsx(t.HeadCell,{children:"Service"}),e.jsx(t.HeadCell,{children:"Version"}),e.jsx(t.HeadCell,{children:"Product"})]}),e.jsx(t.Body,{children:c.ports.map((s,a)=>e.jsxs(t.Row,{children:[e.jsx(t.Cell,{className:"font-mono",children:s.port}),e.jsx(t.Cell,{className:"uppercase",children:s.protocol}),e.jsx(t.Cell,{children:e.jsx(g,{color:s.state==="open"?"success":s.state==="closed"?"gray":s.state==="filtered"?"warning":"gray",size:"sm",children:s.state})}),e.jsx(t.Cell,{children:s.service_name||"—"}),e.jsx(t.Cell,{children:s.service_version||"—"}),e.jsx(t.Cell,{children:s.service_product||"—"})]},a))})]})}):c.scan_status==="completed"?e.jsx("p",{className:"text-center py-4 text-gray-600 dark:text-gray-400",children:"No open ports found"}):e.jsx("p",{className:"text-center py-4 text-gray-600 dark:text-gray-400",children:"Scan in progress or no results yet"})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"No port scan results available for this device."}),L&&e.jsx(m,{color:"gray",onClick:async()=>{const s=v.find(a=>a.mac_address.toLowerCase()===L.toLowerCase()&&a.is_online);s?await z(s.mac_address):D(!1)},children:"Start Port Scan"})]})})]})]})]})]})}export{Oe as Clients};
