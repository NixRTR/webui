import{j as e,C as d,P as b,a as o,b as s}from"./ui-vendor-k77EgL80.js";import{u as F,r as H}from"./react-vendor-DKKOAuGG.js";import{u as D,S as M,N as P}from"./useMetrics-DVfFTjTh.js";import{a as U}from"./index-CV0zGiuG.js";import"./http-vendor-B9ygI19o.js";function A(){const p=localStorage.getItem("access_token"),u=localStorage.getItem("username")||"Unknown",g=F(),[m,x]=H.useState(!1),{connectionStatus:f,system:r,interfaces:v,services:h}=D(p),N=async()=>{await U.logout(),g("/login")},y=l=>{const c=Math.floor(l/86400),n=Math.floor(l%86400/3600),a=Math.floor(l%3600/60);return`${c}d ${n}h ${a}m`},j=l=>(l/1073741824).toFixed(2)+" GB",_=v.filter(l=>["ppp0","br0","br1"].includes(l.interface)),C=l=>{switch(l){case"ppp0":return"WAN";case"br0":return"HOMELAB";case"br1":return"LAN";default:return l}},S=l=>{switch(l){case"ppp0":return"info";case"br0":return"success";case"br1":return"purple";default:return"gray"}};return e.jsxs("div",{className:"flex h-screen",children:[e.jsx(M,{onLogout:N,isOpen:m,onClose:()=>x(!1)}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(P,{hostname:"nixos-router",username:u,connectionStatus:f,onMenuClick:()=>x(!m)}),e.jsxs("main",{className:"flex-1 overflow-y-auto p-6 bg-gray-50 dark:bg-gray-900",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Dashboard"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs(d,{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"CPU Usage"}),e.jsxs("div",{className:"text-3xl font-bold mb-2",children:[r?.cpu_percent.toFixed(1),"%"]}),e.jsx(b,{progress:r?.cpu_percent||0,color:(r?.cpu_percent||0)>80?"red":(r?.cpu_percent||0)>60?"yellow":"blue"})]}),e.jsxs(d,{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Memory Usage"}),e.jsxs("div",{className:"text-3xl font-bold mb-2",children:[r?.memory_percent.toFixed(1),"%"]}),e.jsx(b,{progress:r?.memory_percent||0,color:(r?.memory_percent||0)>80?"red":(r?.memory_percent||0)>60?"yellow":"blue"}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:r&&`${(r.memory_used_mb/1024).toFixed(1)} / ${(r.memory_total_mb/1024).toFixed(1)} GB`})]}),e.jsxs(d,{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Load Average"}),e.jsx("div",{className:"text-3xl font-bold mb-2",children:r?.load_avg_1m.toFixed(2)}),e.jsxs("div",{className:"text-sm text-gray-500",children:["5min: ",r?.load_avg_5m.toFixed(2)," | 15min: ",r?.load_avg_15m.toFixed(2)]})]}),e.jsxs(d,{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Uptime"}),e.jsx("div",{className:"text-2xl font-bold",children:r&&y(r.uptime_seconds)})]})]}),e.jsxs(d,{className:"mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Network Interfaces"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:_.map(l=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold",children:C(l.interface)}),e.jsx(o,{color:S(l.interface),size:"sm",children:l.interface})]}),e.jsx(o,{color:"success",size:"sm",children:"UP"})]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"↓ Download:"}),e.jsxs("span",{className:"font-mono",children:[l.rx_rate_mbps?.toFixed(2)||"0.00"," Mbps"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"↑ Upload:"}),e.jsxs("span",{className:"font-mono",children:[l.tx_rate_mbps?.toFixed(2)||"0.00"," Mbps"]})]}),e.jsxs("div",{className:"flex justify-between text-gray-500",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{className:"font-mono text-xs",children:["↓",j(l.rx_bytes)," ↑",j(l.tx_bytes)]})]})]})]},l.interface))})]}),e.jsxs(d,{children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Services Status"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-3",children:"Network Services"}),e.jsxs(s,{children:[e.jsxs(s.Head,{children:[e.jsx(s.HeadCell,{children:"Service"}),e.jsx(s.HeadCell,{children:"Status"}),e.jsx(s.HeadCell,{children:"PID"}),e.jsx(s.HeadCell,{children:"CPU"}),e.jsx(s.HeadCell,{children:"Memory"})]}),e.jsx(s.Body,{className:"divide-y",children:[{name:"DHCP Server",service:"kea-dhcp4-server"},{name:"Homelab DNS",service:"unbound-homelab"},{name:"LAN DNS",service:"unbound-lan"},{name:"PPPoE",service:"pppd-eno1"},{name:"Dynamic DNS",service:"linode-dyndns"}].map(({name:l,service:c})=>{const n=h.find(i=>i.service_name===c),a=n?n.is_active?"Running":n.is_enabled?"Stopped":"Disabled":"Not Found",t=n?n.is_active?"success":n.is_enabled?"failure":"gray":"gray";return e.jsxs(s.Row,{children:[e.jsx(s.Cell,{className:"font-medium",children:l}),e.jsx(s.Cell,{children:e.jsx(o,{color:t,children:a})}),e.jsx(s.Cell,{children:n?.pid||"-"}),e.jsxs(s.Cell,{children:[n?.cpu_percent?.toFixed(1)||"-","%"]}),e.jsxs(s.Cell,{children:[n?.memory_mb?.toFixed(0)||"-"," MB"]})]},c)})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-3",children:"WebUI Services"}),e.jsxs(s,{children:[e.jsxs(s.Head,{children:[e.jsx(s.HeadCell,{children:"Service"}),e.jsx(s.HeadCell,{children:"Status"}),e.jsx(s.HeadCell,{children:"PID"}),e.jsx(s.HeadCell,{children:"CPU"}),e.jsx(s.HeadCell,{children:"Memory"})]}),e.jsx(s.Body,{className:"divide-y",children:[{name:"Frontend",service:"nginx"},{name:"Backend",service:"router-webui-backend"},{name:"Database",service:"postgresql"},{name:"Speedtest",service:"speedtest",isOneshot:!0}].map(({name:l,service:c,isOneshot:n=!1})=>{const a=h.find(w=>w.service_name===c);let t,i;return a?n?a.is_active?(t="Running",i="success"):a.is_enabled?(t="Waiting",i="warning"):(t="Disabled",i="gray"):a.is_active?(t="Running",i="success"):a.is_enabled?(t="Stopped",i="failure"):(t="Disabled",i="gray"):(t="Not Found",i="gray"),e.jsxs(s.Row,{children:[e.jsx(s.Cell,{className:"font-medium",children:l}),e.jsx(s.Cell,{children:e.jsx(o,{color:i,children:t})}),e.jsx(s.Cell,{children:a?.pid||"-"}),e.jsxs(s.Cell,{children:[a?.cpu_percent?.toFixed(1)||"-","%"]}),e.jsxs(s.Cell,{children:[a?.memory_mb?.toFixed(0)||"-"," MB"]})]},c)})})]})]})]})]})]})]})]})}export{A as Dashboard};
