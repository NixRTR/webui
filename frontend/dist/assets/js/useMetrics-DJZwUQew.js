import{j as e,d as i,e as I,f as S,g as H,h as M,i as W,N as y,k as L,c as R,l as T,m as E,a as D}from"./ui-vendor-CW_Q7vOM.js";import{j as $,L as f,r as t}from"./react-vendor-DKKOAuGG.js";function B({onLogout:n,isOpen:d,onClose:s}){const c=$(),a=()=>{window.innerWidth<1650&&s()};return e.jsxs(e.Fragment,{children:[d&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 xl-custom:hidden",onClick:s}),e.jsx("div",{className:`
          fixed xl-custom:static inset-y-0 left-0 z-50
          transform transition-transform duration-300 ease-in-out
          xl-custom:transform-none
          ${d?"translate-x-0":"-translate-x-full xl-custom:translate-x-0"}
        `,children:e.jsx(i,{"aria-label":"Sidebar with navigation",className:"h-full",children:e.jsxs(i.Items,{children:[e.jsxs(i.ItemGroup,{children:[e.jsx(i.Item,{as:f,to:"/dashboard",icon:I,active:c.pathname==="/dashboard",onClick:a,children:"Dashboard"}),e.jsx(i.Item,{as:f,to:"/network",icon:S,active:c.pathname==="/network",onClick:a,children:"Network"}),e.jsx(i.Item,{as:f,to:"/devices",icon:H,active:c.pathname==="/devices",onClick:a,children:"Devices"}),e.jsx(i.Item,{as:f,to:"/device-usage",icon:S,active:c.pathname==="/device-usage",onClick:a,children:"Device Usage"}),e.jsx(i.Item,{as:f,to:"/system",icon:M,active:c.pathname==="/system",onClick:a,children:"System"})]}),e.jsx(i.ItemGroup,{children:e.jsx(i.Item,{icon:W,onClick:()=>{a(),n()},children:"Logout"})})]})})})]})}function F({hostname:n,username:d,connectionStatus:s,onMenuClick:c}){const a=()=>{const l=document.documentElement;if(l.classList.contains("dark")){l.classList.remove("dark");try{localStorage.setItem("theme","light")}catch{}}else{l.classList.add("dark");try{localStorage.setItem("theme","dark")}catch{}}},r=()=>{switch(s){case"connected":return"success";case"connecting":return"warning";case"error":return"failure";default:return"gray"}};return e.jsxs(y,{fluid:!0,className:"border-b",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:c,className:"p-2 text-gray-500 rounded-lg xl-custom:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600","aria-label":"Toggle menu",children:e.jsx(L,{className:"w-6 h-6"})}),e.jsx(y.Brand,{children:e.jsx("span",{className:"self-center whitespace-nowrap text-xl font-semibold",children:n})})]}),e.jsxs("div",{className:"flex items-center gap-2 md:gap-4",children:[e.jsx(R,{content:"Toggle theme",placement:"bottom",children:e.jsxs("button",{type:"button",onClick:a,className:"p-2 rounded-lg text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:focus:ring-gray-600","aria-label":"Toggle theme",title:"Toggle theme",children:[e.jsx("span",{className:"hidden dark:inline-block",children:e.jsx(T,{className:"w-5 h-5"})}),e.jsx("span",{className:"inline-block dark:hidden",children:e.jsx(E,{className:"w-5 h-5"})})]})}),e.jsxs(D,{color:r(),size:"sm",className:"md:text-base",children:[e.jsx("span",{className:"hidden sm:inline",children:s.charAt(0).toUpperCase()+s.slice(1)}),e.jsx("span",{className:"sm:hidden",children:"â—"})]}),e.jsxs("span",{className:"text-xs md:text-sm",children:[e.jsx("span",{className:"hidden sm:inline",children:"Logged in as: "}),e.jsx("strong",{children:d})]})]})]})}const U=`ws://${window.location.host}/ws`;function _(n){const[d,s]=t.useState("disconnected"),[c,a]=t.useState(null),r=t.useRef(null),l=t.useRef(null),u=t.useRef(0),g=t.useCallback(()=>{if(!(!n||r.current?.readyState===WebSocket.OPEN)){s("connecting");try{const o=new WebSocket(`${U}?token=${encodeURIComponent(n)}`);o.onopen=()=>{console.log("WebSocket connected"),s("connected"),u.current=0},o.onmessage=m=>{a(m)},o.onerror=m=>{console.error("WebSocket error:",m),s("error")},o.onclose=()=>{if(console.log("WebSocket disconnected"),s("disconnected"),r.current=null,n){const m=Math.min(1e3*Math.pow(2,u.current),3e4);u.current+=1,l.current=window.setTimeout(()=>{console.log(`Reconnecting WebSocket (attempt ${u.current})...`),g()},m)}},r.current=o}catch(o){console.error("Failed to create WebSocket:",o),s("error")}}},[n]),p=t.useCallback(o=>{r.current?.readyState===WebSocket.OPEN&&r.current.send(o)},[]);return t.useEffect(()=>(n&&g(),()=>{l.current&&clearTimeout(l.current),r.current&&r.current.close()}),[n,g]),{connectionStatus:d,lastMessage:c,sendMessage:p}}const O=60;function G(n){const{connectionStatus:d,lastMessage:s}=_(n),[c,a]=t.useState(null),[r,l]=t.useState([]),[u,g]=t.useState([]),[p,o]=t.useState([]),[m,j]=t.useState([]),[N,w]=t.useState(new Map);return t.useEffect(()=>{if(s)try{const x=JSON.parse(s.data);if(x.type==="metrics"&&x.data){const h=x.data;a(h.system),l(h.interfaces),g(h.services),o(h.dhcp_clients),j(h.dns_stats),w(v=>{const k=new Map(v);return h.interfaces.forEach(b=>{const C=[...k.get(b.interface)||[],b].slice(-O);k.set(b.interface,C)}),k})}}catch(x){console.error("Failed to parse WebSocket message:",x)}},[s]),{connectionStatus:d,system:c,interfaces:r,services:u,dhcpClients:p,dnsStats:m,interfaceHistory:N}}export{F as N,B as S,G as u};
