import{j as e,u as U,A as M,C as q,L as t,S as A,T as l,B as z}from"./ui-vendor-CLzVGpw3.js";import{u as G,a as s}from"./react-vendor-4URc7N9U.js";import{u as J,S as B,N as H}from"./useMetrics-CslwQGJI.js";import{a as P}from"./index-BnG-Hx-o.js";import"./http-vendor-B9ygI19o.js";function Y(){const i=localStorage.getItem("access_token"),m=localStorage.getItem("username")||"Unknown",c=G(),[o,r]=s.useState(!1),[T,u]=s.useState(!0),[x,h]=s.useState(!1),[v,n]=s.useState(null),[g,d]=s.useState(null),[f,j]=s.useState(!0),[b,p]=s.useState("linode"),[S,y]=s.useState(""),[N,k]=s.useState(""),[D,I]=s.useState(0),[C,w]=s.useState(0),[F,L]=s.useState("5m"),{connectionStatus:E}=J(i);s.useEffect(()=>{if(!i){c("/login");return}O()},[i,c]);const O=async()=>{u(!0),n(null);try{const a=await P.getDynDnsConfig();j(a.enable),p(a.provider),y(a.domain),k(a.subdomain),I(a.domainId),w(a.recordId),L(a.checkInterval)}catch(a){n(a?.response?.data?.detail||a.message||"Failed to load Dynamic DNS configuration")}finally{u(!1)}},_=async()=>{h(!0),n(null),d(null);try{const a={enable:f,provider:b,domain:S,subdomain:N,domainId:D,recordId:C,checkInterval:F};await P.updateDynDnsConfig(a),d("Dynamic DNS configuration saved successfully"),await O()}catch(a){n(a?.response?.data?.detail||a.message||"Failed to save Dynamic DNS configuration")}finally{h(!1)}},R=()=>{localStorage.removeItem("access_token"),localStorage.removeItem("username"),c("/login")};return T?e.jsxs("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx(B,{onLogout:R,isOpen:o,onClose:()=>r(!1)}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(H,{hostname:"nixos-router",username:m,connectionStatus:E,onMenuClick:()=>r(!o)}),e.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:e.jsx("div",{className:"text-center text-gray-600 dark:text-gray-400",children:"Loading..."})})]})]}):e.jsxs("div",{className:"flex h-screen bg-gray-50 dark:bg-gray-900",children:[e.jsx(B,{onLogout:R,isOpen:o,onClose:()=>r(!1)}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(H,{hostname:"nixos-router",username:m,connectionStatus:E,onMenuClick:()=>r(!o)}),e.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(U,{className:"w-8 h-8 mr-3 text-blue-600 dark:text-blue-400"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Dynamic DNS"})]}),v&&e.jsx(M,{color:"failure",className:"mb-4",onDismiss:()=>n(null),children:v}),g&&e.jsx(M,{color:"success",className:"mb-4",onDismiss:()=>d(null),children:g}),e.jsx(q,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"enable",className:"mb-2 block",children:"Enable Dynamic DNS"}),e.jsxs(A,{id:"enable",value:f?"true":"false",onChange:a=>j(a.target.value==="true"),children:[e.jsx("option",{value:"true",children:"Enabled"}),e.jsx("option",{value:"false",children:"Disabled"})]})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"provider",className:"mb-2 block",children:"Provider"}),e.jsx(A,{id:"provider",value:b,onChange:a=>p(a.target.value),children:e.jsx("option",{value:"linode",children:"Linode"})})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"domain",className:"mb-2 block",children:"Domain"}),e.jsx(l,{id:"domain",type:"text",placeholder:"example.com",value:S,onChange:a=>y(a.target.value)})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"subdomain",className:"mb-2 block",children:"Subdomain (leave empty for root domain)"}),e.jsx(l,{id:"subdomain",type:"text",placeholder:"",value:N,onChange:a=>k(a.target.value)})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"domainId",className:"mb-2 block",children:"Domain ID"}),e.jsx(l,{id:"domainId",type:"number",value:D,onChange:a=>I(parseInt(a.target.value)||0)})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"recordId",className:"mb-2 block",children:"Record ID"}),e.jsx(l,{id:"recordId",type:"number",value:C,onChange:a=>w(parseInt(a.target.value)||0)})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"checkInterval",className:"mb-2 block",children:"Check Interval"}),e.jsx(l,{id:"checkInterval",type:"text",placeholder:"5m",value:F,onChange:a=>L(a.target.value)}),e.jsx("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:"How often to check and update the DNS record (e.g., 5m, 1h)"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(z,{onClick:_,disabled:x,children:x?"Saving...":"Save Configuration"})})]})})]})})]})]})}export{Y as DynDnsConfig};
